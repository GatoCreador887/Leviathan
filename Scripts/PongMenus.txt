FileType: Script;
script-type: gui;
script-name: PongMenus;
RocketScript: Pong.rml

objects {
    // this keeps the GUI always on //
    o GuiCollection "OnKeeper"{
        l params{
            Enabled = true;
            KeepsGUIOn = true;
        }
    }
    // keeps the menu background visible while in menus //
    o GuiCollection "Menus"{
        l params{
            Enabled = true;
        }
        s scripts{
            inl type(script){
                name = MenuScript;
                body{
                    // we can just include our common code //
                    string ROCKETOBJECTID("menubody");
                    
                    #include "DefaultCollectionScript.as";
                    
                @%};
            }
        }
    }
    // Pause menu, which can only be enabled during gameplay //
    o GuiCollection "PauseMenu"{
        l params{
            Enabled = false;
            AllowEnable = false;
            ToggleOn = "ESC";
        }
        s scripts{
            inl type(script){
                name = MenuScript;
                body{
                    // We need some special functionality
                    // set's the visibility of the object //
                    void HandleSet(GuiCollection@ Instance, bool hidden){
                        // fetch pointers
                        GuiLoadedSheet@ tmpsheet = Instance.GetOwningSheet();
                        RocketElement@ maincontainer = tmpsheet.GetElementByID("pausemenubody");
                        
                        if(hidden){
                            //Print("Collection "+Instance.GetName()+" set hidden");
                            maincontainer.SetProperty("visibility", "hidden");
                            maincontainer.SetProperty("display", "none");
                        } else {
                            //Print("Collection "+Instance.GetName()+" set visible");
                            maincontainer.SetProperty("visibility", "visible");
                            maincontainer.SetProperty("display", "block");
                        }
                    }

                    [@Listener="OnHide"]
                    int OnHide(GuiCollection@ Instance, Event@ event){
                        // we need to hide our elements //
                        HandleSet(Instance, true);
                        // Resume game //
                        GetPongGame().SetPauseState(false);
                        return 1;
                    }

                    [@Listener="OnShow"]
                    int OnShow(GuiCollection@ Instance, Event@ event){
                        // we need to show our elements //
                        HandleSet(Instance, false);
                        GetPongGame().SetPauseState(true);
                        return 1;
                    }
                    
                @%};
            }
        }
    
    }
    
    // groups together the top level menu //
    o GuiCollection "MainMenu"{
        l params{
            Enabled = true;
        }
        s scripts{
            inl type(script){
                name = MainMenuScript;
                body{
                    // we can just include our common code //
                    string ROCKETOBJECTID("topmenu");
                    
                    #include "DefaultCollectionScript.as";
                    
                @%};
            }
        }
    }
    
    o GuiCollection "GameSetupScreen"{
        l params{
            Enabled = false;
        }
        s scripts{
            inl type(script){
                name = GameSetupScreenScript;
                body{
                    // Used to only create once //
                    bool IsCreated = false;
                    // We need some special functionality
                    // set's the visibility of the object //
                    void HandleSet(GuiCollection@ Instance, bool hidden){
                        // fetch pointers
                        GuiLoadedSheet@ tmpsheet = Instance.GetOwningSheet();
                        RocketElement@ maincontainer = tmpsheet.GetElementByID("gamesetupscreen");
                        
                        if(hidden){
                            //Print("Collection "+Instance.GetName()+" set hidden");
                            maincontainer.SetProperty("visibility", "hidden");
                            maincontainer.SetProperty("display", "none");
                        } else {
                            //Print("Collection "+Instance.GetName()+" set visible");
                            maincontainer.SetProperty("visibility", "visible");
                            maincontainer.SetProperty("display", "block");
                        }
                    }

                    [@Listener="OnHide"]
                    int OnHide(GuiCollection@ Instance, Event@ event){
                        // we need to hide our elements //
                        HandleSet(Instance, true);
                        return 1;
                    }

                    [@Listener="OnShow"]
                    int OnShow(GuiCollection@ Instance, Event@ event){
                        // we need to show our elements //
                        HandleSet(Instance, false);
                        // Special event to let the GUI update everything
                        if(!IsCreated){
                            GetEventHandler().CallEvent(GenericEvent("UpdateLocalGameSetup"));
                            IsCreated = true;
                        }
                        return 1;
                    }
                    
                @%};
            }
        }
    }
    
    o GuiCollection "MatchScoresScreen"{
        l params{
            Enabled = false;
        }
        s scripts{
            inl type(script){
                name = MatchScoresScreen;
                body{
                    // we can just include our common code //
                    string ROCKETOBJECTID("matchendscreen");
                    
                    #include "DefaultCollectionScript.as";
                    
                @%};
            }
        }
    }
    
    o GuiObject ID(100) "GameStartButton"{
        l params{
            RocketID = "GameStartBtn";
        }
        s scripts{
            inl type(script){
                name = GameStarterScriptButton;
                body{
                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // try to start the game if possible //
                        
                        int result = GetPongGame().StartGame();
                        if(result < 0){
                            // something failed //
                            string error = "<span class=\"Inline\" style=\"color: #93002F;\">Error: ";
                            error += GetPongGame().GetErrorString();
                            Instance.SetInternalElementRML(error+"</span>");
                        } else {
                            // hide game setup screen, display during game GUI //
                            Instance.GetOwningManager().SetCollectionState("GameSetupScreen", false);
                            Instance.GetOwningManager().SetCollectionState("Menus", false);
                            Instance.GetOwningManager().SetCollectionState("GameplayHUD", true);
                        }
                        return 1;
                    }
                @%};
            }    
        }
    }
    o GuiObject ID(101) "GameQuitButton"{
        l params{
            RocketID = "QuitButton";
        }
        s scripts{
            inl type(script){
                name = GameStarterScriptButton;
                body{
                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // close the game //
                        GetPongGame().Quit();

                        return 1;
                    }
                @%};
            }    
        }
    }
    o GuiObject ID(103) "ToSetupScreenButton"{
        l params{
            RocketID = "GameSetupScreenBtn";
        }
        s scripts{
            inl type(script){
                name = GameStarterScriptButton;
                body{
                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // hide other collections and display the game setup screen //
                        Instance.GetOwningManager().SetCollectionState("GameSetupScreen", true);
                        Instance.GetOwningManager().SetCollectionState("MainMenu", false);

                        return 1;
                    }
                @%};
            }    
        }
    }
    o GuiObject ID(104) "BackFromGameSetupScreen"{
        l params{
            RocketID = "SetupScreenBack";
        }
        s scripts{
            inl type(script){
                name = GameStarterScriptButton;
                body{
                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // hide other collections and display the main menu screen //
                        Instance.GetOwningManager().SetCollectionState("GameSetupScreen", false);
                        Instance.GetOwningManager().SetCollectionState("MainMenu", true);

                        return 1;
                    }
                @%};
            }    
        }
    }
    
    // during game HUD //
    o GuiCollection "GameplayHUD"{
        l params{
            Enabled = false;
        }
        s scripts{
            inl type(script){
                name = GameHUDScript;
                body{
                    // we can just include our common code //
                    string ROCKETOBJECTID("hudmain");
                    
                    #include "DefaultCollectionScript.as";
                    
                @%};
            }
        }
    }
    
    o GuiObject ID(200) "PlayerScoresHandler"{
        l params{
            RocketID = "scorelist";
        }
        s scripts{
            inl type(script){
                name = GameScoreUpdater;
                body{
                    #include "ScoreboardUpdateScript.as";
                
                    // we use generic event to receive game start and score update events //
                    [@Listener="Generic", @Type="GameStart"]
                    int OnGameStarted(BaseGuiObject@ Instance, GenericEvent@ event){
                        // Call update function which handless everything related to scoreboard //
                        UpdateScoreboard(Instance);
                        return 1;
                    }
                    
                    [@Listener="Generic", @Type="ScoreUpdated"]
                    int OnScoresUpdated(BaseGuiObject@ Instance, GenericEvent@ event){
                        // Call update function which handless everything related to scoreboard //
                        UpdateScoreboard(Instance);
                        return 1;
                    }
                    
                @%};
            }
        }
    }
    
    o GuiObject ID(203) "PauseBackToMenuButton"{
        l params{
            RocketID = "PauseScreenMenuButton";
        }
        s scripts{
            inl type(script){
                name = GameStarterScriptButton;
                body{
                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // hide other collections and display the main menu screen //
                        Instance.GetOwningManager().SetCollectionState("MainMenu", true);
                        Instance.GetOwningManager().SetCollectionState("Menus", true);
                        Instance.GetOwningManager().SetCollectionState("GameplayHUD", false);
                        Instance.GetOwningManager().SetCollectionState("PauseMenu", false);
                        
                        GetPongGame().GameMatchEnded();
                        
                        return 1;
                    }
                @%};
            }    
        }
    }
    
    o GuiObject ID(204) "PauseQuitFromWinScreen"{
        l params{
            RocketID = "PauseScreenQuitButton";
        }
        s scripts{
            inl type(script){
                name = GameStarterScriptButton;
                body{

                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // close the game //
                        GetPongGame().Quit();

                        return 1;
                    }
                @%};
            }    
        }
    }
    o GuiObject ID(105) "ClosePauseMenu"{
        l params{
            RocketID = "PauseMenuClose";
        }
        s scripts{
            inl type(script){
                name = PauseMenuCloseScript;
                body{
                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // Hide the pause menu collection //
                        Instance.GetOwningManager().SetCollectionState("PauseMenu", false);
                        return 1;
                    }
                @%};
            }    
        }
    }
    
    // ------------------ Game setup screen ------------------ //
    o GuiObject ID(500) "LocalGameSetupScreenTable"{
        l params{
            RocketID = "LocalGameSetupOptions";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    [@Listener="Generic", @Type="UpdateLocalGameSetup"]
                    int OnUpdateMenu(BaseGuiObject@ Instance, GenericEvent@ event){
                        // Call the method in the included file //
                        UpdateGameSetupScreen(Instance, "LocalGameSetup_");
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    
    // Huge dump of objects for the setup screen handling //
    // TODO: add template support
    o GuiObject ID(510) "LocalSetup_Colour0"{
        l params{
            RocketID = "LocalGameSetup_Colour_0";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 0;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ColourChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalSetup_Colour1"{
        l params{
            RocketID = "LocalGameSetup_Colour_1";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 1;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ColourChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(511) "LocalSetup_Colour2"{
        l params{
            RocketID = "LocalGameSetup_Colour_2";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 2;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ColourChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(511) "LocalSetup_Colour3"{
        l params{
            RocketID = "LocalGameSetup_Colour_3";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 3;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ColourChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    
    o GuiObject ID(510) "LocalSetup_Colour10"{
        l params{
            RocketID = "LocalGameSetup_Colour_10";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 10;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ColourChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalSetup_Colour21"{
        l params{
            RocketID = "LocalGameSetup_Colour_21";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 21;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ColourChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(511) "LocalSetup_Colour32"{
        l params{
            RocketID = "LocalGameSetup_Colour_32";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 32;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ColourChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(511) "LocalSetup_Colour43"{
        l params{
            RocketID = "LocalGameSetup_Colour_43";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 43;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ColourChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    
    o GuiObject ID(510) "LocalSetup_Controls0"{
        l params{
            RocketID = "LocalGameSetup_Controls_0";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 0;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ControlChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalSetup_Controls1"{
        l params{
            RocketID = "LocalGameSetup_Controls_1";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 1;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ControlChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(511) "LocalSetup_Controls2"{
        l params{
            RocketID = "LocalGameSetup_Controls_2";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 2;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ControlChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(511) "LocalSetup_Controls3"{
        l params{
            RocketID = "LocalGameSetup_Controls_3";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 3;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ControlChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    
    o GuiObject ID(510) "LocalSetup_Controls10"{
        l params{
            RocketID = "LocalGameSetup_Controls_10";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 10;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ControlChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalSetup_Controls21"{
        l params{
            RocketID = "LocalGameSetup_Controls_21";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 21;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ControlChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(511) "LocalSetup_Controls32"{
        l params{
            RocketID = "LocalGameSetup_Controls_32";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 32;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ControlChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(511) "LocalSetup_Controls43"{
        l params{
            RocketID = "LocalGameSetup_Controls_43";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 43;
                    
                    [@Listener="OnValueChange"]
                    int OnvalueChanged(BaseGuiObject@ Instance, RocketEvent@ event){
                        ControlChangeUpdated(ControlIdentifier, event.GetValue("value"));
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    
    
    
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Split_0";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 0;
                    
                    [@Listener="OnClick"]
                    int OnSplitSlot(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnSlotSplit(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Split_1";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 1;
                    
                    [@Listener="OnClick"]
                    int OnSplitSlot(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnSlotSplit(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Split_2";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 2;
                    
                    [@Listener="OnClick"]
                    int OnSplitSlot(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnSlotSplit(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Split_3";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 3;
                    
                    [@Listener="OnClick"]
                    int OnSplitSlot(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnSlotSplit(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }

    
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Join_0";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 0;
                    
                    [@Listener="OnClick"]
                    int ListenerJoin(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnPlayerJoined(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Join_1";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 1;
                    
                    [@Listener="OnClick"]
                    int ListenerJoin(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnPlayerJoined(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Join_2";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 2;
                    
                    [@Listener="OnClick"]
                    int ListenerJoin(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnPlayerJoined(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Join_3";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 3;
                    
                    [@Listener="OnClick"]
                    int ListenerJoin(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnPlayerJoined(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Join_10";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 10;
                    
                    [@Listener="OnClick"]
                    int ListenerJoin(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnPlayerJoined(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Join_21";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 21;
                    
                    [@Listener="OnClick"]
                    int ListenerJoin(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnPlayerJoined(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Join_32";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 32;
                    
                    [@Listener="OnClick"]
                    int ListenerJoin(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnPlayerJoined(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    o GuiObject ID(510) "LocalGameSetupScriptElement0"{
        l params{
            RocketID = "LocalGameSetup_Join_43";
        }
        s scripts{
            inl type(script){
                name = LocalGameSetupScreenTableUpdater;
                body{
                    #include "PongGameSetupMenu.as";
                    
                    int ControlIdentifier = 43;
                    
                    [@Listener="OnClick"]
                    int ListenerJoin(BaseGuiObject@ Instance, RocketEvent@ event){
                        OnPlayerJoined(ControlIdentifier, "LocalGameSetup_", Instance);
                        return 1;
                    }
                    
                    
                @%};
            }
        }
    }
    
    // ------------------ Match end screen ------------------ //
    o GuiObject ID(300) "WinningPlayersHandler"{
        l params{
            RocketID = "playerwinnerlist";
        }
        s scripts{
            inl type(script){
                name = GameWinnersUpdater;
                body{
                    // Generics event to detect game end //
                    [@Listener="Generic", @Type="MatchEnded"]
                    int OnGameEnd(BaseGuiObject@ Instance, GenericEvent@ event){
                        // We can get the winning team number for the event //
                        int winningteam = event.GetNamedVars().GetSingleValueByName("WinningTeam").
                            ConvertAndReturnInt();
                        
                        string text = "<p>Team "+winningteam;
                        
                        // Find the players in the winning team //
                        PlayerSlot@ slot = GetPongGame().GetSlot(winningteam);
                        // Loop through and print all players in the team //
                        while(true){
                            // get score //
                            int score = slot.GetScore();
                            int number = slot.GetPlayerNumber();
                            text += "<p style='padding-left: 10px;'>Player "+number+": "+score+"</p>";

                            @slot = slot.GetSplit();
                            if(slot is null)
                                break;
                        }
                        text += "</p>";
                        Instance.SetInternalElementRML(text);
                        // Make it visible //
                        Instance.GetOwningManager().SetCollectionState("MatchScoresScreen", true);
                        Instance.GetOwningManager().SetCollectionState("GameplayHUD", false);
                        return 1;
                    }
                @%};
            }
        }
    }
    
    o GuiObject ID(301) "WinningScreenScoreboard"{
        l params{
            RocketID = "winnerscreenscorelist";
        }
        s scripts{
            inl type(script){
                name = WinningScreenScoreboardUpdater;
                body{
                    #include "ScoreboardUpdateScript.as";
                    
                    // Generic event to detect game end //
                    [@Listener="Generic", @Type="MatchEnded"]
                    int OnGameEnd(BaseGuiObject@ Instance, GenericEvent@ event){
                        // Call update function which handless everything related to scoreboard //
                        UpdateScoreboard(Instance);
                        return 1;
                    }
                @%};
            }
        }
    }
    
    o GuiObject ID(302) "WinningGameBackToMenuButton"{
        l params{
            RocketID = "WinScreenMenuButton";
        }
        s scripts{
            inl type(script){
                name = GameStarterScriptButton;
                body{
                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // hide other collections and display the main menu screen //
                        Instance.GetOwningManager().SetCollectionState("MatchScoresScreen", false);
                        Instance.GetOwningManager().SetCollectionState("MainMenu", true);
                        Instance.GetOwningManager().SetCollectionState("Menus", true);
                        
                        GetPongGame().GameMatchEnded();
                        
                        return 1;
                    }
                @%};
            }    
        }
    }
    
    o GuiObject ID(303) "GameQuitFromWinScreen"{
        l params{
            RocketID = "WinScreenQuitButton";
        }
        s scripts{
            inl type(script){
                name = GameStarterScriptButton;
                body{

                    [@Listener="OnClick"]
                    int OnClick(BaseGuiObject@ Instance, RocketEvent@ event){
                        // close the game //
                        GetPongGame().Quit();

                        return 1;
                    }
                @%};
            }    
        }
    }
    
}
